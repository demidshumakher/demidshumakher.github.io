# Билет 41. Принцип отражений. Явная формула для чисел Каталана. 

## Принцип отражения

Рассмотрим все 2n-звенные ломаные, ведущие из $(0, 0)$ в $(2n, 0)$ по точкам с целыми координатами, звенья которых - диагонали единичных квадратиков.
- Ломаная - хорошая, если она не опускается
ниже оси $OX$ и плохая в противном случае. 
  - Всего ломаных $C^n_{2n}$ из них хороших - $c_n$
  - А сколько плохих ломаных?
- Плохая ломаная пересекает прямую $y = −1$
  - Рассмотрим первую точку пересечения и отразим идущую после этой точки часть ломаной относительно прямой $y = −1$
  - Получим ломаную, ведущую из $(0, 0)$ в $(2n, −2)$
- Обратно, любая ломаная из $(0, 0)$ в $(2n, −2)$ пересекает $y = −1$
  - Рассмотрим первую точку пересечения и отразим идущую после этой точки часть ломаной относительно прямой $y = −1$
  - Получим плохую ломаную из $(0, 0)$ в $(2n, 0)$
- Итого, плохих ломаных столько же, сколько ломаных
  из $(0, 0)$ в $(2n, −2)$. Легко видеть, что их $C^{n-1}_{2n}$

## Явная формула для чисел Каталана

### Теорема

$c_n = \frac{C_{2n}^n}{n + 1}$

>#### Доказательство {collapsible = "true"}
> - $c_n$ - количество хороших ломаных из $(0,0)$ в $(2n,0)$
> Всего ломаных $C_{2n}^n$
> Плохих ломаных $C_{2n}^{n-1}$
> Следовательно  
> $c_n = C_{2n}^n - C_{2n}^{n-1} = $
> $\frac{(2n)!}{n!n!} - \frac{(2n)!}{(n-1)!(n+1)!} = $
> $\frac{(2n)!(n+1-n)}{n!(n+1)!} = \frac{C_{2n}^n}{n+1}$
